Properties localProperties = new Properties()

def localPropertiesFile = project.rootProject.file('local.properties')

if (localPropertiesFile.exists()) {
    localProperties.load(localPropertiesFile.newDataInputStream())
}

ext.readSecret = { secretName ->
    def localPropSecret = localProperties.getProperty(secretName)

    def secret = (localPropSecret != null) ? localPropSecret : System.getenv(secretName)

    return maybeWrapInQuotes(secret)
}

static def maybeWrapInQuotes(content){
    return content.startsWith("\"") ? content : "\"" + content + "\""
}